@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Administration/Views/Shared/_LayoutAdmin.cshtml";
}

<div class="table-wrapper venues-table section">
    <div class="row-fluid head">
        <div class="span12">
            <h4>Events</h4>
        </div>
    </div>
    <div class="row-fluid filter-block">
        <div class="pull-right">
            
        </div>
    </div>
    <div id="pad-wrapper">
        <div class="row-fluid">
            <div id="ProvinceTable" style="width: 100%; margin: auto;"></div>
        </div>
    </div>
    <!-- end events table -->
</div>
<style>
    .jtable-input-field-container {
        width:280px;
        float:left;
        margin-left:30px;
        border-bottom:none !important;
    }
    .ui-dialog .ui-dialog-content form {
        width: 620px;
        overflow: hidden;
        padding-bottom: 20px;
        margin-bottom:10px;
    }
    textarea,input[type='text'],select {
        width:250px !important;
    }
    .input-append input[type='text'] {
        width:216px !important;
    }
</style>
<script>
    $(document).ready(function () {
        var jtable_config = {
            title: 'Danh sách Sự kiện',
            paging: true,
            pageSize: 5,
            sorting: true,
            fileUpload:true,
            /*selecting: true,
            multiselect: true,
            selectingCheckboxes:true,*/
            actions: {
                base: {}
            },
            fields: {
                EventId: {
                    key: true,
                    create: false,
                    edit: false,
                    list: false
                },
                EventName: {
                    title: 'Tên sự kiện',
                    validation: [
                        "required"
                    ]
                },
                TmpEventImage :{
                    type : "hidden"
                },
                EventImage: {
                    title: "Hình minh họa",
                    list: false,
                    input: function (data) {
                        if (data.record) {
                            var imgSrc = data.record.TmpEventImage || Url(data.record.EventImage)
                            if (imgSrc == "") {
                                imgSrc = Url("~/Content/Images/no_image.jpg");
                            }
                            return $("<img src='" + imgSrc + "' class='previewUpload img-polaroid'/><input type='file' name='EventImage' class='previewUpload'/>")
                        } else {
                            return $("<img class='previewUpload img-polaroid' src='" + Url("~/Content/Images/no_image.jpg") + "' /><input type='file' name='EventImage' class='previewUpload'/>")
                        }
                    }
                },
                Description:{
                    title: "Chú thích",
                    type:"textarea",
                    list:false
                },
                Artist: {
                    title: 'Nghệ sĩ',
                    validation: ["required"]
                },
                HoldDate: {
                    title: "Ngày tổ chức",
                    validation: ["required"],
                    type: "datetime",
                    displayFormat: "dd/MM/yyyy hh:mm:ss"/*,
                    input: function (data) {
                        var html = "";
                        if (data.record) {
                            html += "<div class='input-append' id='HoldDatePicker'><input value='" + $.format.date($.hik.jtable.prototype._parseDate(data.value), "dd-MM-yyyy hh:mm") + "' class='validate[required]' data-format='dd-MM-yyyy hh:mm' type='text' name='HoldDate' data-toggle='datetimepicker'/><span class='add-on'><i class='icon-calendar'></i></span></div>"
                        } else {
                            html += "<div class='input-append' id='HoldDatePicker'><input class='validate[required]' data-format='dd-MM-yyyy hh:mm' type='text' name='HoldDate' data-toggle='datetimepicker'/><span class='add-on'><i class='icon-calendar'></i></span></div>"
                        }
                        return html;
                    }*/
                },
                CategoryId: {
                    title: "Danh mục",
                    validation: ["required"],
                    options: Url({ Controller: "Category", Action: "GetOptions" })
                },
                VenueId: {
                    title: "Địa điểm",
                    validation: ["required"],
                    options: Url({ Controller: "Venue", Action: "GetOptions" })
                }
            },
            formCreated: function (event,form) {
                $("#HoldDatePicker").datetimepicker({ pickSeconds: false, maskInput: false });
                previewUpload();
                $(".jtable-dialog-form > div.jtable-input-field-container").eq(1).css({ float: "right" });
            },
            rowUpdated: function (event, data) {
                data.record.TmpEventImage = $("img.previewUpload").attr("src");
            }
        }

        $('#ProvinceTable').jtable(dropit.jtInit(jtable_config));
        $('#ProvinceTable').jtable('load');
    });
</script>